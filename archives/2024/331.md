---
title: Taro 自定义 TabBar for H5 示例
number: '#331'
link: 'https://github.com/toFrankie/blog/issues/331'
created_at: '2024-03-16 01:14:07'
updated_at: '2024-03-16 02:26:34'
labels:
  - '2023'
  - React
  - 前端
---
## 背景

最近在做 Taro 项目，有微信小程序和 H5 两端，因导航栏样式无法满足要求，需实现自定义 TabBar。

目前 Taro for H5 未默认支持自定义 TabBar，详见 [#10049](https://github.com/NervJS/taro/issues/10049)。

## 开始之前

相关链接：

- [微信小程序自定义 tabBar](https://developers.weixin.qq.com/miniprogram/dev/framework/ability/custom-tabbar.html)
- [微信小程序自定义 Tabbar（Taro）](https://taro-docs.jd.com/docs/custom-tabbar)

注意事项：

- 文件名为 `custom-tab-bar`，且放在 `src` 目录下。
- 完整配置 `tabBar` 字段，一是为了向下兼容，二是不配置的情况下 H5 端切换页面的体验很差。后者不确定是否因为 Taro 不支持所以没做兼容。
- 由于 H5 端未得到官方支持，因此配置 `custom: true` 编译为 H5 时是无效的。

实现思路：

对于微信小程序来说，Taro 已经支持了，这个不多说，按要求写就能正常显示。而 H5 则在 TabBar 页面中引入 `custom-tab-bar` 即可。有两个问题，一是内置的 TabBar 仍然存在，通过样式将其屏蔽掉。二是，在 TabBar 页面切换时，由于组件不会重新挂载，可能不会触发重新渲染，为避免 Tab 的高亮状态不正确，需在 `onShow` 时机进行设置。

引入 `custom-tab-bar` 页面的方式有两种，一是在每个 TabBar 页面中手动引入（一般不会很多），二是通过插件（比如 [taro-inject-component-loader](https://github.com/xdoer/taro-inject-component-loader)）自动插入到每个页面。后者，还需要在组件内进一步判断，若是 TabBar 的路由则显示自定义 TabBar 的内容，否则不显示。


## 实现

> 下文以 React 为例。

配置就不说了。

```diff
// app.config.js

export default defineAppConfig({
  tabBar: {
+   custom: true,
    // ...
  },
})
```



未完待续...
