# JavaScript 作用域链其一：作用域链定义

> [原文](https://web.archive.org/web/20210423081947/http://www.nowamagic.net/librarys/veda/detail/1675)

一个执行上下文 的数据（变量、函数声明和函数的形参）作为属性存储在变量对象中。变量对象在每次进入上下文时创建，并填入初始值，值的更新出现在代码执行阶段。

这一章专门讨论与执行上下文直接相关的更多细节，这次我们将提及一个议题——作用域链。

如果要简要的描述并展示其重点，那么作用域链大多数与内部函数相关。

我们知道，ECMAScript 允许创建内部函数，我们甚至能从父函数中返回这些函数。

```js
var x = 10

function foo() {
  var y = 20
  function bar() {
    alert(x + y)
  }
  return bar
}

foo()() // 30
```

这样，很明显每个上下文拥有自己的变量对象：对于全局上下文，它是全局对象自身；对于函数，它是活动对象。

作用域链正是内部上下文所有变量对象（包括父变量对象）的列表。此链用来变量查询。即在上面的例子中，“bar”上下文的作用域链包括 AO(bar)、AO(foo)和 VO(global)。

但是，让我们仔细研究这个问题。

让我们从定义开始，并进深一步的讨论示例。

> 作用域链与一个执行上下文相关，变量对象的链用于在标识符解析中变量查找。

函数上下文的作用域链在函数调用时创建的，包含活动对象和这个函数内部的 `[[Scope]]` 属性。下面我们将更详细的讨论一个函数的 `[[Scope]]` 属性。

在上下文中示意如下：

```js
activeExecutionContext = {
    VO: {...}, // or AO
    this: thisValue,
    Scope: [ // Scope chain
      // 所有变量对象的列表
      // for identifiers lookup
    ]
};
```

其 scope 定义如下：

```js
Scope = AO + [[Scope]]
```

这种联合和标识符解析过程，我们将在下面讨论，这与函数的生命周期相关。
